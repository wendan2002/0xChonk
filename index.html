<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>0xChonk | Fat Cat Protocol</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        
        body {
            font-family: 'Press Start 2P', cursive;
            background-color: #0f0f0f;
            color: #ff9f43;
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
        }

        /* --- ÂãïÁï´ÁâπÊïàÂçÄ --- */
        @keyframes breathe { 0% { transform: scale(1); } 50% { transform: scale(1.02); } 100% { transform: scale(1); } }
        .cat-idle { animation: breathe 3s infinite ease-in-out; }
        .cat-tap { animation: tap-bounce 0.1s cubic-bezier(0.1, 0.7, 1.0, 0.1); filter: brightness(1.3) contrast(1.1); }
        @keyframes tap-bounce { 0% { transform: scale(1); } 50% { transform: scale(0.92); } 100% { transform: scale(1); } }
        
        @keyframes floatUp { 0% { opacity: 1; transform: translateY(0) scale(1); } 100% { opacity: 0; transform: translateY(-80px) scale(1.5); } }
        .float-num { position: absolute; color: white; font-size: 28px; pointer-events: none; animation: floatUp 0.6s ease-out forwards; z-index: 50; text-shadow: 3px 3px 0 #000; -webkit-text-stroke: 1px black; }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .page { display: none; width: 100%; height: 100%; flex-direction: column; }
        .page.active { display: flex; animation: fadeIn 0.2s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        .modal-bg { background: rgba(0,0,0,0.9); backdrop-filter: blur(5px); }
        .slide-up { animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1); }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
    </style>
</head>
<body class="h-screen flex flex-col bg-gray-900">

    <!-- È†ÇÈÉ®Ë≥áË®äÊ¨Ñ -->
    <div class="h-16 px-4 flex justify-between items-center z-20 bg-gray-800 border-b-4 border-white shrink-0">
        <div class="flex items-center gap-2">
            <div class="w-8 h-8 bg-orange-500 border-2 border-white flex items-center justify-center text-black text-xs font-bold shadow-[2px_2px_0_0_#000]">0x</div>
            <div class="flex flex-col">
                <span class="text-[8px] text-gray-400">LVL <span id="user-level">1</span></span>
                <span class="text-xs text-white">PLAYER_1</span>
            </div>
        </div>
        <button id="wallet-btn" onclick="toggleWalletModal()" class="flex items-center gap-2 bg-black border-2 border-gray-600 px-3 py-1.5 active:translate-y-1 transition-all">
            <i data-lucide="wallet" class="w-4 h-4 text-gray-400"></i>
            <span id="wallet-text" class="text-[10px] text-gray-400 truncate max-w-[80px]">Connect</span>
        </button>
    </div>

    <!-- === È†ÅÈù¢ 1: ÊåñÁ§¶ (MINE) === -->
    <div id="view-mine" class="page active items-center justify-center relative">
        <div class="mb-2 text-center z-10">
            <div class="text-[8px] text-gray-500 mb-2 tracking-widest uppercase">Total Balance</div>
            <div class="text-3xl text-white drop-shadow-md flex items-center justify-center gap-2">
                <img src="https://cdn-icons-png.flaticon.com/512/12196/12196486.png" class="w-6 h-6 animate-pulse filter invert" />
                <span id="score-display">0</span>
            </div>
            <div class="text-[10px] text-green-400 mt-1 flex items-center justify-center gap-1">
                <i data-lucide="zap" class="w-3 h-3"></i> <span id="ppc-display">100</span> / tap
            </div>
        </div>

        <div class="relative cursor-pointer select-none group" id="cat-btn">
            <div class="absolute inset-0 bg-orange-500/20 rounded-full blur-2xl group-active:bg-orange-500/50 transition-all duration-75"></div>
            <div class="w-64 h-64 rounded-full border-4 border-white overflow-hidden relative shadow-[0_0_0_4px_#000,0_10px_20px_rgba(0,0,0,0.5)] cat-idle bg-blue-800 flex items-center justify-center">
                <!-- ÂúñÁâáÔºö‰ΩøÁî®ÊÇ®ÁöÑ Github ÈÄ£Áµê -->
                <img src="https://github.com/wendan2002/0xChonk/blob/main/0xchonk.jpg.jpg?raw=true" 
                     class="w-full h-full object-cover scale-110" 
                     alt="Fat Cat" 
                     onerror="this.style.display='none'; this.parentElement.innerHTML='<span style=\'font-size:100px\'>üòº</span>'">
            </div>
        </div>

        <div class="mt-6 w-64 mx-auto z-10">
            <div class="flex justify-between text-[10px] text-white mb-1 px-1">
                <span class="flex items-center gap-1">‚ö° ENERGY</span>
                <span id="energy-text">1000/1000</span>
            </div>
            <div class="w-full h-4 bg-gray-700 border-2 border-white relative shadow-[2px_2px_0_0_#000]">
                <div id="energy-bar" class="h-full bg-gradient-to-r from-yellow-500 to-orange-500 w-full transition-all duration-200"></div>
            </div>
        </div>
        
        <!-- V1.4 Êñ∞Â¢ûÔºöÂïÜÂ∫óÊåâÈàï -->
        <button onclick="toggleShopModal()" class="mt-4 bg-orange-600 text-white text-xs px-6 py-3 border-2 border-white shadow-[4px_4px_0_0_#000] active:translate-y-1 active:shadow-none transition-all flex items-center gap-2 group">
            <i data-lucide="shopping-cart" class="w-4 h-4 group-hover:scale-110 transition-transform"></i> UPGRADE SHOP
        </button>
    </div>

    <!-- === È†ÅÈù¢ 2: ÊéíË°åÊ¶ú (LEADERBOARD) - V1.4 Êñ∞Â¢û === -->
    <div id="view-leaderboard" class="page p-6 overflow-y-auto no-scrollbar">
        <div class="text-center mb-6">
            <h2 class="text-xl text-white mb-1">HALL OF FAME</h2>
            <p class="text-[10px] text-gray-500">Top Fat Cats</p>
        </div>
        
        <!-- ÊÇ®ÁöÑÊéíÂêç -->
        <div class="bg-gray-800 border-2 border-white p-4 mb-4 flex items-center justify-between shadow-[4px_4px_0_0_#000]">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-orange-500 rounded-full flex items-center justify-center text-black font-bold border-2 border-white">YOU</div>
                <div>
                    <div class="text-xs text-white">PLAYER_1</div>
                    <div class="text-[10px] text-yellow-400" id="lb-your-score">0 CHONK</div>
                </div>
            </div>
            <div class="text-xl font-bold text-gray-500">#999+</div>
        </div>

        <!-- ÂÅáÊï∏ÊìöÂàóË°® -->
        <div class="space-y-2" id="leaderboard-list"></div>
    </div>

    <!-- === È†ÅÈù¢ 3: ‰ªªÂãô (EARN) === -->
    <div id="view-earn" class="page p-6 overflow-y-auto no-scrollbar">
        <h2 class="text-xl text-white text-center mb-6">SOCIAL TASKS</h2>
        <div class="space-y-4 w-full max-w-md mx-auto">
            <div class="bg-gray-800 border-2 border-white p-3 shadow-[4px_4px_0_0_#000] relative group">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-black border-2 border-white flex items-center justify-center shrink-0"><i data-lucide="twitter" class="text-blue-400 w-5 h-5"></i></div>
                    <div class="flex-1">
                        <div class="text-[10px] text-white mb-1">Follow on X</div>
                        <div class="text-[10px] text-yellow-400">+5,000 CHONK</div>
                    </div>
                    <button id="btn-twitter" onclick="handleTask('twitter', 'https://x.com/wendan2002?s=21&t=ay2DEKE011j_yvvPXPAMJg', 5000)" class="bg-yellow-400 text-black text-[10px] px-3 py-2 border-b-4 border-yellow-600 active:border-0 active:translate-y-1 font-bold">GO</button>
                </div>
            </div>
            <div class="bg-gray-800 border-2 border-white p-3 shadow-[4px_4px_0_0_#000] relative group">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-black border-2 border-white flex items-center justify-center shrink-0"><i data-lucide="send" class="text-blue-300 w-5 h-5"></i></div>
                    <div class="flex-1">
                        <div class="text-[10px] text-white mb-1">Join Community</div>
                        <div class="text-[10px] text-yellow-400">+5,000 CHONK</div>
                    </div>
                    <button id="btn-telegram" onclick="handleTask('telegram', 'https://t.me/zeroxchonk', 5000)" class="bg-yellow-400 text-black text-[10px] px-3 py-2 border-b-4 border-yellow-600 active:border-0 active:translate-y-1 font-bold">GO</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Â∫ïÈÉ®Â∞éËà™ (Êõ¥Êñ∞ÔºöÂä†ÂÖ• RANK ÊåâÈàï) -->
    <div class="h-20 bg-gray-800 border-t-4 border-white flex justify-around items-center px-2 shrink-0 z-20">
        <button onclick="switchTab('mine')" class="nav-btn flex flex-col items-center gap-1 p-2 text-yellow-400 transition-colors" id="nav-mine"><i data-lucide="pickaxe" class="w-6 h-6"></i><span class="text-[8px]">MINE</span></button>
        <button onclick="switchTab('leaderboard')" class="nav-btn flex flex-col items-center gap-1 p-2 text-gray-500 hover:text-white transition-colors" id="nav-leaderboard"><i data-lucide="trophy" class="w-6 h-6"></i><span class="text-[8px]">RANK</span></button>
        <button onclick="switchTab('earn')" class="nav-btn flex flex-col items-center gap-1 p-2 text-gray-500 hover:text-white transition-colors" id="nav-earn"><i data-lucide="coins" class="w-6 h-6"></i><span class="text-[8px]">EARN</span></button>
    </div>

    <!-- V1.4 Êñ∞Â¢ûÔºöÂïÜÂ∫óÂΩàÁ™ó (Shop Modal) -->
    <div id="shop-modal" class="fixed inset-0 modal-bg z-50 hidden flex-col items-center justify-end sm:justify-center p-4">
        <div class="bg-gray-800 border-4 border-white p-6 w-full max-w-sm shadow-[8px_8px_0_0_#000] relative slide-up">
            <button onclick="toggleShopModal()" class="absolute top-2 right-2 text-gray-400 hover:text-white"><i data-lucide="x" class="w-6 h-6"></i></button>
            <h3 class="text-white text-center mb-6 text-sm flex items-center justify-center gap-2"><i data-lucide="shopping-cart" class="w-4 h-4"></i> UPGRADE SHOP</h3>
            
            <div class="space-y-4">
                <!-- ÂçáÁ¥öÈ†ÖÁõÆ 1 -->
                <div class="bg-gray-900 p-3 border-2 border-gray-600 flex justify-between items-center">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-blue-900 border border-blue-500 flex items-center justify-center"><i data-lucide="zap" class="text-yellow-400 w-5 h-5"></i></div>
                        <div>
                            <div class="text-[10px] text-white font-bold">Power Glove</div>
                            <div class="text-[8px] text-gray-400">+100 per tap</div>
                        </div>
                    </div>
                    <button onclick="buyUpgrade('tap')" class="bg-yellow-400 text-black text-[10px] px-3 py-1 border-b-2 border-yellow-600 active:border-0 active:translate-y-1 font-bold flex flex-col items-center min-w-[70px]">
                        <span>BUY</span>
                        <span id="price-tap">500</span>
                    </button>
                </div>
                <!-- ÂçáÁ¥öÈ†ÖÁõÆ 2 -->
                <div class="bg-gray-900 p-3 border-2 border-gray-600 flex justify-between items-center">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-green-900 border border-green-500 flex items-center justify-center"><i data-lucide="battery-charging" class="text-green-400 w-5 h-5"></i></div>
                        <div>
                            <div class="text-[10px] text-white font-bold">Energy Drink</div>
                            <div class="text-[8px] text-gray-400">+500 Max Energy</div>
                        </div>
                    </div>
                    <button onclick="buyUpgrade('energy')" class="bg-yellow-400 text-black text-[10px] px-3 py-1 border-b-2 border-yellow-600 active:border-0 active:translate-y-1 font-bold flex flex-col items-center min-w-[70px]">
                        <span>BUY</span>
                        <span id="price-energy">1000</span>
                    </button>
                </div>
            </div>
            <p class="text-[8px] text-center text-gray-500 mt-4">Spend CHONK to earn faster!</p>
        </div>
    </div>

    <!-- Èå¢ÂåÖÂΩàÁ™ó -->
    <div id="wallet-modal" class="fixed inset-0 modal-bg z-50 hidden flex-col items-center justify-center p-4">
        <div class="bg-gray-800 border-4 border-white p-6 w-full max-w-xs shadow-[8px_8px_0_0_#000] relative">
            <button onclick="toggleWalletModal()" class="absolute top-2 right-2 text-gray-400 hover:text-white"><i data-lucide="x" class="w-5 h-5"></i></button>
            <h3 class="text-white text-center mb-6 text-sm">CONNECT WALLET</h3>
            <div class="space-y-3">
                <button onclick="simulateConnect('Phantom')" class="w-full bg-purple-900 border-2 border-white p-3 flex items-center gap-3 hover:bg-purple-800 transition-colors">
                    <div class="w-8 h-8 bg-purple-500 rounded-full"></div><span class="text-xs text-white">Phantom</span>
                </button>
                <button onclick="simulateConnect('Metamask')" class="w-full bg-orange-900 border-2 border-white p-3 flex items-center gap-3 hover:bg-orange-800 transition-colors">
                    <div class="w-8 h-8 bg-orange-500 rounded-full"></div><span class="text-xs text-white">Metamask</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();

        // Ê†∏ÂøÉÊï∏Êìö (Âæû localStorage ËÆÄÂèñ)
        let score = parseInt(localStorage.getItem('chonk_score')) || 0;
        let tapLevel = parseInt(localStorage.getItem('chonk_tap_lvl')) || 1;
        let energyLevel = parseInt(localStorage.getItem('chonk_energy_lvl')) || 1;
        let walletAddress = localStorage.getItem('chonk_wallet');
        
        // V1.4 Êñ∞Â¢ûÔºöÊï∏ÂÄºË®àÁÆóÈÇèËºØ
        let pointsPerTap = 100 * tapLevel;
        let maxEnergy = 1000 + (energyLevel - 1) * 500;
        let energy = maxEnergy; // ÊØèÊ¨°ÈáçÈñãË£úÊªøÔºåÁÇ∫‰∫ÜÈ´îÈ©óÂ•Ω
        let tapPrice = 500 * Math.pow(2, tapLevel - 1);
        let energyPrice = 1000 * Math.pow(2, energyLevel - 1);

        // DOM ÂÖÉÁ¥†
        const scoreDisplay = document.getElementById('score-display');
        const ppcDisplay = document.getElementById('ppc-display');
        const energyBar = document.getElementById('energy-bar');
        const energyText = document.getElementById('energy-text');
        const catBtn = document.getElementById('cat-btn');

        // ÂàùÂßãÂåñ
        if(walletAddress) updateWalletUI(walletAddress);
        updateUI();
        initLeaderboard();

        // --- ÈªûÊìäÈÇèËºØ ---
        catBtn.addEventListener('mousedown', handleTap);
        catBtn.addEventListener('touchstart', (e) => { e.preventDefault(); handleTap(e.touches[0]); });

        function handleTap(e) {
            if (energy < 10) return;
            energy -= 10;
            score += pointsPerTap;
            saveData();
            updateUI();

            const container = catBtn.querySelector('div');
            container.classList.remove('cat-idle');
            container.style.animation = 'none';
            container.offsetHeight; 
            container.style.animation = null; 
            container.classList.add('cat-tap');
            setTimeout(() => { container.classList.remove('cat-tap'); container.classList.add('cat-idle'); }, 100);

            const rect = catBtn.getBoundingClientRect();
            const x = e.clientX || (rect.left + rect.width/2);
            const y = e.clientY || (rect.top + rect.height/2);
            showFloatingText(x, y, `+${pointsPerTap}`);

            if (navigator.vibrate) navigator.vibrate(20);
        }

        // --- V1.4 Êñ∞Â¢ûÔºöÂïÜÂ∫óÈÇèËºØ ---
        function toggleShopModal() {
            const modal = document.getElementById('shop-modal');
            modal.classList.toggle('hidden');
            modal.classList.toggle('flex');
            // Êõ¥Êñ∞ÂÉπÊ†ºÈ°ØÁ§∫
            document.getElementById('price-tap').innerText = tapPrice;
            document.getElementById('price-energy').innerText = energyPrice;
        }

        function buyUpgrade(type) {
            if (type === 'tap') {
                if (score >= tapPrice) {
                    score -= tapPrice;
                    tapLevel++;
                    tapPrice = 500 * Math.pow(2, tapLevel - 1);
                    pointsPerTap = 100 * tapLevel;
                    alert("Power Glove Upgraded! Tap power increased.");
                } else {
                    alert("Not enough CHONK!");
                }
            } else if (type === 'energy') {
                if (score >= energyPrice) {
                    score -= energyPrice;
                    energyLevel++;
                    energyPrice = 1000 * Math.pow(2, energyLevel - 1);
                    maxEnergy = 1000 + (energyLevel - 1) * 500;
                    energy = maxEnergy; // Ë£úÊªø
                    alert("Energy Drink Consumed! Max Energy increased.");
                } else {
                    alert("Not enough CHONK!");
                }
            }
            saveData();
            updateUI();
            toggleShopModal(); // ÈóúÈñâ‰∏¶ÈáçÊñ∞ÊâìÈñã‰ª•Êõ¥Êñ∞ÂÉπÊ†ºÈ°ØÁ§∫
            toggleShopModal();
        }

        // --- V1.4 Êñ∞Â¢ûÔºöÊéíË°åÊ¶úÂÅáÊï∏Êìö ---
        function initLeaderboard() {
            const list = document.getElementById('leaderboard-list');
            const fakeUsers = [
                { name: "Elon_Musk", score: "999,999,999" },
                { name: "Vitalik_ETH", score: "500,000,000" },
                { name: "Satoshi", score: "100,000,000" },
                { name: "Doge_King", score: "50,000,000" },
                { name: "Pepe_Frog", score: "10,000,000" }
            ];
            
            fakeUsers.forEach((u, i) => {
                const color = i === 0 ? 'text-yellow-400' : (i === 1 ? 'text-gray-400' : (i === 2 ? 'text-orange-700' : 'text-gray-600'));
                list.innerHTML += `
                    <div class="flex justify-between items-center p-3 border-b border-gray-700">
                        <div class="flex items-center gap-3">
                            <div class="text-sm font-bold ${color}">#${i+1}</div>
                            <div class="text-xs text-white">${u.name}</div>
                        </div>
                        <div class="text-xs text-gray-400 font-mono">${u.score}</div>
                    </div>
                `;
            });
        }

        // --- ÂÖ±ÈÄöÈÇèËºØ ---
        function handleTask(id, url, reward) {
            const btn = document.getElementById(`btn-${id}`);
            if(btn.disabled) return;
            window.open(url, '_blank');
            btn.innerText = "VERIFYING...";
            btn.classList.add('opacity-50');
            setTimeout(() => {
                score += reward;
                saveData();
                updateUI();
                btn.innerText = "CLAIMED";
                btn.disabled = true;
                btn.classList.replace('bg-yellow-400', 'bg-green-500');
                btn.classList.replace('border-yellow-600', 'border-green-700');
                btn.classList.replace('text-black', 'text-white');
                btn.classList.remove('opacity-50');
            }, 3000);
        }

        function toggleWalletModal() {
            const modal = document.getElementById('wallet-modal');
            modal.classList.toggle('hidden');
            modal.classList.toggle('flex');
        }

        function simulateConnect(provider) {
            const btn = document.querySelector(`button[onclick="simulateConnect('${provider}')"]`);
            const originalText = btn.innerHTML;
            btn.innerHTML = `<span class="animate-pulse">Connecting...</span>`;
            setTimeout(() => {
                const mockAddr = "0x" + Math.random().toString(16).substr(2, 4).toUpperCase() + "..." + "CHONK";
                localStorage.setItem('chonk_wallet', mockAddr);
                updateWalletUI(mockAddr);
                toggleWalletModal();
                btn.innerHTML = originalText;
                alert(`Connected to ${provider} successfully!`);
            }, 1500);
        }

        function updateWalletUI(addr) {
            const btn = document.getElementById('wallet-btn');
            const txt = document.getElementById('wallet-text');
            btn.classList.replace('bg-black', 'bg-green-900');
            btn.classList.replace('border-gray-600', 'border-green-500');
            txt.innerText = addr;
            txt.classList.replace('text-gray-400', 'text-green-300');
        }

        function switchTab(tabName) {
            document.querySelectorAll('.page').forEach(el => el.classList.remove('active'));
            document.getElementById(`view-${tabName}`).classList.add('active');
            document.querySelectorAll('.nav-btn').forEach(el => { el.classList.remove('text-yellow-400'); el.classList.add('text-gray-500'); });
            document.getElementById(`nav-${tabName}`).classList.remove('text-gray-500');
            document.getElementById(`nav-${tabName}`).classList.add('text-yellow-400');
        }

        function showFloatingText(x, y, text) {
            const el = document.createElement('div');
            el.className = 'float-num';
            el.innerText = text;
            const randomX = (Math.random() - 0.5) * 40;
            el.style.left = (x + randomX) + 'px';
            el.style.top = (y - 50) + 'px';
            document.body.appendChild(el);
            setTimeout(() => el.remove(), 600);
        }

        function updateUI() {
            scoreDisplay.innerText = score.toLocaleString();
            document.getElementById('lb-your-score').innerText = `${score.toLocaleString()} CHONK`;
            ppcDisplay.innerText = pointsPerTap;
            energyText.innerText = `${Math.floor(energy)}/${maxEnergy}`;
            energyBar.style.width = `${(energy/maxEnergy)*100}%`;
            document.getElementById('user-level').innerText = tapLevel;
        }

        function saveData() { 
            localStorage.setItem('chonk_score', score);
            localStorage.setItem('chonk_tap_lvl', tapLevel);
            localStorage.setItem('chonk_energy_lvl', energyLevel);
        }

        setInterval(() => { if (energy < maxEnergy) { energy += 5; if(energy > maxEnergy) energy = maxEnergy; updateUI(); } }, 1000);
    </script>
</body>
</html>
